import{r,a as i,j as t,F as p,R as q,u as w,b as A}from"./index-f7c5f2e7.js";import{F as B,d as M}from"./index-b3c681c3.js";import{useCategories as Q}from"./CategoiresContext-e0e81007.js";import{a as H}from"./SetOutFucntions-f088c140.js";import"./firebase-config-409fc865.js";function $({title:u=Text,text:o=Text}){const[a,n]=r.useState(),d=1e3;return r.useEffect(()=>{n(i("div",{className:"popup",style:{animation:`poping ${d}ms`},children:[t("h3",{className:"title",children:u}),t("p",{className:"text",children:o})]})),setTimeout(()=>n(t(p,{})),d)},[]),a}const k=({photos:u})=>{const o=r.useRef([]),a=r.useRef([]),n=e=>{e&&!o.current.includes(e)&&o.current.push(e)},d=e=>{e&&!a.current.includes(e)&&a.current.push(e)},l=e=>{o.current.forEach((s,f)=>{const v=a.current[f];v.classList.remove("active"),s.classList.remove("active"),e===f&&(s.classList.add("active"),v.classList.add("active"))})},m=u.map((e,s)=>i(q.Fragment,{children:[t("img",{className:`${s===0?"active":""}`,src:e,alt:"",ref:n}),i("button",{style:{translate:`0 calc(${s}rem + 100% * ${s})`},className:`${s===0?"active":""}`,ref:d,onMouseOver:()=>l(s),children:[" ",t("img",{className:"active",src:e,alt:""})]})]},s));return t(p,{children:m})};const z=({optionName:u,options:o,changeOptions:a})=>{const n=r.useRef([]),d=m=>{const e=n.current[m];n.current=n.current.map(s=>{var f;return(f=s.classList)==null||f.remove("active"),s}),e.classList.add("active"),a(u,e.innerText)},l=r.useMemo(()=>o.map((m,e)=>t("span",{ref:s=>n.current[e]=s,className:e===0?"option active":"option",onClick:()=>d(e),children:m},`${m}-${e}`)),[]);return i("div",{className:"option-selector",children:[i("h3",{children:[u," :"]}),t("div",{className:"selector-bar",children:l})]})},D=z;function W(){var F;const[u,o]=r.useState(()=>!0),[a,n]=r.useState(()=>({}));r.useEffect(()=>{},[]);const d=w();let{productDirec:l}=A();const m=l.split("-")[0],e=parseInt(l.split("-")[1]),[s,f]=r.useState(1),[v,N]=r.useState(t(p,{})),{products:y}=Q(),{addFavorite:C,addToCart:S}=H(),x=r.useRef(),E=r.useMemo(()=>y.find(c=>c.category.id===m&&parseInt(c.id)===parseInt(e)),[y]);if(E===void 0)return t(p,{});const{price:I,photos:R,title:g,details:T,options:b}=E;function j(){S(l,s,a).then(()=>{n(()=>({})),d("/cart")})}function L(c,O){n(h=>(h[c]=O,h))}const P=(F=Object.keys(b))==null?void 0:F.map((c,O)=>((a==null?void 0:a[c])==null&&u&&n(h=>(o(!1),h[c]=b[c][0],h)),t(D,{changeOptions:L,optionName:c,options:[...b[c]]},c)));return t("div",{className:"container",children:i("main",{className:"product-container flex",children:[t("div",{className:"img-box flex justify-ce align-ce",children:t(k,{photos:R})}),i("div",{className:"details",children:[t("h2",{className:"title",children:g}),i("p",{className:"price",children:[I," $"]}),i("div",{children:[P,t("h3",{children:"description"}),i("p",{className:"description",children:[T," "]})]})]}),i("div",{children:[i("div",{className:"quantity flex flex-direc",children:[t("label",{htmlFor:"quantity",children:"Quantity"}),t("input",{type:"number",id:"quantity",value:s,onChange:c=>{f(c.target.value)},min:"1"})]}),i("div",{className:"flex align-ce",children:[t("button",{className:"btn-add",onClick:()=>{S(l,s,a),n(()=>({})),N(t($,{text:g,title:"added to cart"})),setTimeout(()=>N(t(p,{})),1e3)},children:"Add to Cart"}),t("button",{ref:x,className:"btn-favorite",onClick:async()=>{const c=await C(l,x);N(t($,{title:c?"added":"removed",text:g})),setTimeout(()=>N(t(p,{})),1e3)},children:t(B,{icon:M})})]}),t("button",{onClick:j,className:"btn-buy flex justify-ce align-ce",children:"Buy Now"})]}),v]})})}export{W as default};
