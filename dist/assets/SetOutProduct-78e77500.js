import{r as o,a,j as t,F as p,R as T,u as j,b as L}from"./index-9fcefab8.js";import{F as P,d as q}from"./index-4950111c.js";import{useCategories as w}from"./CategoiresContext-562232d7.js";import{a as A}from"./SetOutFucntions-b315eaf2.js";import"./firebase-config-409fc865.js";function S({title:d=Text,text:n=Text}){const[l,i]=o.useState(),r=1e3;return o.useEffect(()=>{i(a("div",{className:"popup",style:{animation:`poping ${r}ms`},children:[t("h3",{className:"title",children:d}),t("p",{className:"text",children:n})]})),setTimeout(()=>i(t(p,{})),r)},[]),l}const B=({photos:d})=>{const n=o.useRef([]),l=o.useRef([]),i=e=>{e&&!n.current.includes(e)&&n.current.push(e)},r=e=>{e&&!l.current.includes(e)&&l.current.push(e)},f=e=>{n.current.forEach((s,m)=>{const h=l.current[m];h.classList.remove("active"),s.classList.remove("active"),e===m&&(s.classList.add("active"),h.classList.add("active"))})},u=d.map((e,s)=>a(T.Fragment,{children:[t("img",{className:`${s===0?"active":""}`,src:e,alt:"",ref:i}),a("button",{style:{translate:`0 calc(${s}rem + 100% * ${s})`},className:`${s===0?"active":""}`,ref:r,onMouseOver:()=>f(s),children:[" ",t("img",{className:"active",src:e,alt:""})]})]},s));return t(p,{children:u})};const D=({optionName:d,options:n,changeOptions:l})=>{const i=o.useRef([]),r=u=>{const e=i.current[u];i.current=i.current.map(s=>{var m;return(m=s.classList)==null||m.remove("active"),s}),e.classList.add("active"),l(d,e.innerText)},f=o.useMemo(()=>n.map((u,e)=>t("span",{ref:s=>i.current[e]=s,className:"option",onClick:()=>r(e),children:u},`${u}-${e}`)),[]);return a("div",{className:"option-selector",children:[a("h3",{children:[d," :"]}),t("div",{className:"selector-bar",children:f})]})},M=D,v={};function J(){var x;const d=j();let{productDirec:n}=L();const l=n.split("-")[0],i=parseInt(n.split("-")[1]),[r,f]=o.useState(1),[u,e]=o.useState(t(p,{})),{products:s}=w(),{addFavorite:m,addToCart:h}=A(),b=o.useRef(),y=o.useMemo(()=>s.find(c=>c.category.id===l&&parseInt(c.id)===parseInt(i)),[s]);if(y===void 0)return t(p,{});const{price:$,photos:C,title:N,details:E,options:g}=y;function R(){h(n,r,v).then(()=>d("/cart"))}function F(c,O){v[c]=O}const I=(x=Object.keys(g))==null?void 0:x.map((c,O)=>(v[c]==null&&(v[c]=g[c][0]),t(M,{changeOptions:F,optionName:c,options:[...g[c]]},c)));return t("div",{className:"container",children:a("main",{className:"product-container flex",children:[t("div",{className:"img-box flex justify-ce align-ce",children:t(B,{photos:C})}),a("div",{className:"details",children:[t("h2",{className:"title",children:N}),a("p",{className:"price",children:[$," $"]}),a("div",{children:[I,t("h3",{children:"description"}),a("p",{className:"description",children:[E," "]})]})]}),a("div",{children:[a("div",{className:"quantity flex flex-direc",children:[t("label",{htmlFor:"quantity",children:"Quantity"}),t("input",{type:"number",id:"quantity",value:r,onChange:c=>{f(c.target.value)},min:"1"})]}),a("div",{className:"flex align-ce",children:[t("button",{className:"btn-add",onClick:()=>{h(n,r,v),e(t(S,{text:N,title:"added to cart"})),setTimeout(()=>e(t(p,{})),1e3)},children:"Add to Cart"}),t("button",{ref:b,className:"btn-favorite",onClick:async()=>{const c=await m(n,b);e(t(S,{title:c?"added":"removed",text:N})),setTimeout(()=>e(t(p,{})),1e3)},children:t(P,{icon:q})})]}),t("button",{onClick:R,className:"btn-buy flex justify-ce align-ce",children:"Buy Now"})]}),u]})})}export{J as default};
